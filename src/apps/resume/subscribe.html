<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!--Import materialize.css-->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
	<!--Let browser know website is optimized for mobile-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<body>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
  <script src="https://cdn.firebase.com/js/client/2.3.2/firebase.js"></script>
  <link rel="stylesheet" type="text/css" href="resume_DM.css">
 
  <div class="navbar">
    <nav>
      <div class="nav-wrapper blue-grey" id="SPpark-nav">
        <!-- the href refreshes the page, but its all daynamic so its only for the user -->
        <a href="index.html" class="brand-logo center">R&#233;sum&#233;</a>
          <ul class="right hide-on-small-and-down">
            <li class="active"><a href="subscribe.html">Subscribe</a></li>
            <li><a href="cities.html">Cities</a></li>
          </ul>
      </div>
    </nav>
  </div>

  <div class="container">
    <div class="row">
	  <div class="col s6"><h1> Subscribe </h1></div>
	</div>

	<div class="row">
	  <div class="input-field col s12 grey lighten-2">
	    <input id="email" type="email" class="validate">
		<label for="email" data-error="Not_valid">Email</label>
	  </div>
	</div>
	
	<div class="row">
	  <div class="input-field col s12">
	    <a class="waves-effect waves-light btn right blue-grey" id="submit">
		<i class="material-icons right">email</i>Submit</a>
	  </div>
	</div>
	
	<div class="row">
	  <h3>Current Subscribers</h3>
	  <ul class="collection" id="emails">
	</div>
  </div>

<script>

    var root = new Firebase('https://ucdd-4830-004.firebaseio.com/')
    var taskListRef = root.child('email')
      $('#submit').click(function() {
    	console.log('the submit button is clicked')
    	var email = $('#email').val()
    	var taskObject = {
    		email: email
    	}

    	if (email == "") {
    		alert("Invalid entry detected.");
    		console.log("INVALID ENTRY")
    		return
    	}
    	else {
    		var newTaskRef = taskListRef.push()
    		newTaskRef.set(taskObject)
    	}
    	Materialize.toast('You have been subscribed!', 2000)
        })

    var ref = new Firebase('https://ucdd-4830-004.firebaseio.com/')
      ref.child('email').orderByValue().on('value', function(snapshot) {
        var emails = snapshot
        document.getElementById("emails").innerHTML = "";
        snapshot.forEach(function(snapshot) {
          emails = snapshot.val()
        $('#emails').append('<li>' + emails.email + '</li>')
        })
    })

</script>
	
</body>
</html>